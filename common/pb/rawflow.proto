syntax = "proto3";
package input;
option go_package = "akvorado/common/pb";

// RawFlow is an undecoded flow with some options.
message RawFlow {
    uint64 time_received = 1;                         // when the flow was received
    bytes payload = 2;                                // payload of the flow
    bytes source_address = 3;                         // source IPv6 address
    bool use_source_address = 4;                      // use source address as exporter address
    Decoder decoder = 5;                              // use this specific decoder
    TimestampSource timestamp_source = 6;             // source of the timestamp
    DecapsulationProtocol decapsulation_protocol = 7; // protocol to decap

    enum Decoder {
        DECODER_UNSPECIFIED = 0;
        DECODER_NETFLOW = 1;
        DECODER_SFLOW = 2;
        DECODER_GOB = 3;
    }
    enum TimestampSource {
        TS_INPUT = 0;
        TS_NETFLOW_PACKET = 1;
        TS_NETFLOW_FIRST_SWITCHED = 2;
    }
    enum DecapsulationProtocol {
        DECAP_NONE = 0;
        DECAP_IPIP = 1;
        DECAP_GRE = 2;
        DECAP_VXLAN = 3;
        DECAP_SRV6 = 4;
    }
}
